file_path,long_name,start_line_new,end_line_new,start_line_old,end_line_old,line_num,mod_type,mod
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,36,"""added""","""import java.util.HashSet;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,178,"""deleted""","""    private Pattern excludedPattern = Pattern.compile(ExcludedPatterns.CLASS_ACCESS_PATTERN, Pattern.CASE_INSENSITIVE);"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,179,"""added""","""    private Set<Pattern> excludedPatterns = new HashSet<Pattern>();"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,180,"""added""",""""""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::CookieInterceptor()""",181,185,-1,-1,181,"""added""","""    public CookieInterceptor() {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::CookieInterceptor()""",181,185,-1,-1,182,"""added""","""        for (String pattern : ExcludedPatterns.EXCLUDED_PATTERNS) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::CookieInterceptor()""",181,185,-1,-1,183,"""added""","""            excludedPatterns.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::CookieInterceptor()""",181,185,-1,-1,184,"""added""","""        }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::CookieInterceptor()""",181,185,-1,-1,185,"""added""","""    }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,256,"""deleted""","""        boolean matches = !excludedPattern.matcher(value).matches();"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,257,"""deleted""","""        if (!matches) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,258,"""deleted""","""            if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,259,"""deleted""","""                LOG.trace(""Cookie value [#0] matches excludedPattern [#1]"", value, ExcludedPatterns.CLASS_ACCESS_PATTERN);"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,262,"""deleted""","""        return matches;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,263,"""added""","""        for (Pattern excludedPattern : excludedPatterns) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,264,"""added""","""            boolean matches = !excludedPattern.matcher(value).matches();"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,265,"""added""","""            if (!matches) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,266,"""added""","""                if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,267,"""added""","""                    LOG.trace(""Cookie value [#0] matches excludedPattern [#1]"", value, excludedPattern.toString());"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,268,"""added""","""                }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,269,"""added""","""                return false;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isAcceptableValue( String value)""",262,273,255,263,272,"""added""","""        return true;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,296,"""deleted""","""     * Checks if name of Cookie match {@link #excludedPattern}"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,302,"""deleted""","""        boolean matches = excludedPattern.matcher(name).matches();"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,303,"""deleted""","""        if (matches) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,304,"""deleted""","""            if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,305,"""deleted""","""                LOG.trace(""Cookie [#0] matches excludedPattern [#1]"", name, ExcludedPatterns.CLASS_ACCESS_PATTERN);"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,306,"""deleted""","""            }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,306,"""added""","""     * Checks if name of Cookie match {@link #excludedPatterns}"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,307,"""deleted""","""        } else {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,308,"""deleted""","""            if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""""",-1,-1,-1,-1,309,"""deleted""","""                LOG.trace(""Cookie [#0] doesn't match excludedPattern [#1]"", name, ExcludedPatterns.CLASS_ACCESS_PATTERN);"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,312,"""deleted""","""        return matches;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,312,"""added""","""        for (Pattern excludedPattern : excludedPatterns) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,313,"""added""","""            boolean matches = excludedPattern.matcher(name).matches();"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,314,"""added""","""            if (matches) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,315,"""added""","""                if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,316,"""added""","""                    LOG.trace(""Cookie [#0] matches excludedPattern [#1]"", name, excludedPattern.toString());"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,317,"""added""","""                }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,318,"""added""","""                return true;"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,319,"""added""","""            } else {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,320,"""added""","""                if (LOG.isTraceEnabled()) {"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,321,"""added""","""                    LOG.trace(""Cookie [#0] doesn't match excludedPattern [#1]"", name, excludedPattern.toString());"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,322,"""added""","""                }"""
"""core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java""","""CookieInterceptor::isExcluded( String name)""",311,326,301,313,325,"""added""","""        return false;"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,386,"""added""","""    public void testCookiesWithStrutsInternalsAccess() throws Exception {"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,387,"""added""","""        MockHttpServletRequest request = new MockHttpServletRequest();"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,388,"""added""","""        String sessionCookieName = ""session.userId"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,389,"""added""","""        String sessionCookieValue = ""session.userId=1"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,390,"""added""","""        String appCookieName = ""application.userId"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,391,"""added""","""        String appCookieValue = ""application.userId=1"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,392,"""added""","""        String reqCookieName = ""request.userId"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,393,"""added""","""        String reqCookieValue = ""request.userId=1"";"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,394,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,395,"""added""","""        request.setCookies("""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,396,"""added""","""                new Cookie(sessionCookieName, ""1""),"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,397,"""added""","""                new Cookie(""1"", sessionCookieValue),"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,398,"""added""","""                new Cookie(appCookieName, ""1""),"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,399,"""added""","""                new Cookie(""1"", appCookieValue),"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,400,"""added""","""                new Cookie(reqCookieName, ""1""),"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,401,"""added""","""                new Cookie(""1"", reqCookieValue)"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,402,"""added""","""            );"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,403,"""added""","""        ServletActionContext.setRequest(request);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,404,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,405,"""added""","""        final Map<String, Boolean> excludedName = new HashMap<String, Boolean>();"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,406,"""added""","""        final Map<String, Boolean> excludedValue = new HashMap<String, Boolean>();"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,407,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,408,"""added""","""        CookieInterceptor interceptor = new CookieInterceptor() {"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,409,"""added""","""            @Override"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,410,"""added""","""            protected boolean isAcceptableName(String name) {"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,411,"""added""","""                boolean accepted = super.isAcceptableName(name);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,412,"""added""","""                excludedName.put(name, accepted);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,413,"""added""","""                return accepted;"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,414,"""added""","""            }"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,415,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,416,"""added""","""            @Override"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,417,"""added""","""            protected boolean isAcceptableValue(String value) {"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,418,"""added""","""                boolean accepted = super.isAcceptableValue(value);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,419,"""added""","""                excludedValue.put(value, accepted);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,420,"""added""","""                return accepted;"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,421,"""added""","""            }"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,422,"""added""","""        };"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,423,"""added""","""        interceptor.setCookiesName(""*"");"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,424,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,425,"""added""","""        MockActionInvocation invocation = new MockActionInvocation();"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,426,"""added""","""        invocation.setAction(new MockActionWithCookieAware());"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,427,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,428,"""added""","""        interceptor.intercept(invocation);"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,429,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,430,"""added""","""        assertFalse(excludedName.get(sessionCookieName));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,431,"""added""","""        assertFalse(excludedName.get(appCookieName));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,432,"""added""","""        assertFalse(excludedName.get(reqCookieName));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,433,"""added""",""""""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,434,"""added""","""        assertFalse(excludedValue.get(sessionCookieValue));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,435,"""added""","""        assertFalse(excludedValue.get(appCookieValue));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,436,"""added""","""        assertFalse(excludedValue.get(reqCookieValue));"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""CookieInterceptorTest::testCookiesWithStrutsInternalsAccess()""",386,437,-1,-1,437,"""added""","""    }"""
"""core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java""","""""",-1,-1,-1,-1,438,"""added""",""""""

file_path,long_name,start_line_new,end_line_new,start_line_old,end_line_old,line_num,mod_type,mod
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""""",-1,-1,-1,-1,22,"""added""","""import org.primeframework.jwt.domain.InvalidJWTSignatureException;"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,68,"""deleted""","""    // Be particular about decoding an unsecured JWT. If the JWT is signed or any verifiers were provided don't do it."""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,69,"""deleted""","""    if (header.algorithm == Algorithm.none && parts.length == 2 && verifiers.length == 0) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,69,"""added""","""    // If parts.length == 2 we have no signature, if no verifiers were provided, decode if header says 'none', else throw an exception"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,70,"""deleted""","""      return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,70,"""added""","""    if (parts.length == 2 && verifiers.length == 0) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,71,"""added""","""      if (header.algorithm == Algorithm.none) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,72,"""added""","""        return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,73,"""added""","""      } else {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,74,"""added""","""        throw new InvalidJWTSignatureException();"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Verifier ... verifiers)""",61,87,60,82,75,"""added""","""      }"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,118,"""deleted""","""    // Be particular about decoding an unsecured JWT. If the JWT is signed or any verifiers were provided don't do it."""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,119,"""deleted""","""    if (header.algorithm == Algorithm.none && parts.length == 2 && verifiers.isEmpty()) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,120,"""deleted""","""      return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,123,"""added""","""    // If parts.length == 2 we have no signature, if no verifiers were provided, decode if header says 'none', else throw an exception"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,124,"""added""","""    if (parts.length == 2 && verifiers.isEmpty()) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,125,"""added""","""      if (header.algorithm == Algorithm.none) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,126,"""added""","""        return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,127,"""added""","""      } else {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,128,"""added""","""        throw new InvalidJWTSignatureException();"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Map<String,Verifier> verifiers , Function<Header,String> keyFunction)""",117,142,112,133,129,"""added""","""      }"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Header header , String [ ] parts , Verifier verifier)""",152,186,143,172,162,"""added""","""    // A verifier was provided but no signature exists, this is treated as an invalid signature."""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Header header , String [ ] parts , Verifier verifier)""",152,186,143,172,163,"""added""","""    if (parts.length == 2 && verifier != null) {"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Header header , String [ ] parts , Verifier verifier)""",152,186,143,172,164,"""added""","""      throw new InvalidJWTSignatureException();"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Header header , String [ ] parts , Verifier verifier)""",152,186,143,172,165,"""added""","""    }"""
"""src/main/java/org/primeframework/jwt/JWTDecoder.java""","""JWTDecoder::decode( String encodedJWT , Header header , String [ ] parts , Verifier verifier)""",152,186,143,172,166,"""added""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,2,"""deleted""",""" * Copyright (c) 2016-2017, Inversoft Inc., All Rights Reserved"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,2,"""added""",""" * Copyright (c) 2016-2018, Inversoft Inc., All Rights Reserved"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,20,"""added""","""import org.primeframework.jwt.domain.InvalidJWTSignatureException;"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,197,"""deleted""","""  @Test"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,198,"""deleted""","""  public void test_badEncoding() throws Exception {"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,199,"""deleted""","""    Verifier verifier = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(""src/test/resources/rsa_public_key_2048.pem""))));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,200,"""deleted""","""    // add a space to the header, invalid Base64 character point 20 (space)"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,201,"""deleted""","""    expectException(InvalidJWTException.class, ()"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,202,"""deleted""","""        -> JWT.getDecoder().decode(""eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9 .foo.bar"", verifier));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,203,"""deleted""","""  }"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,204,"""deleted""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,225,"""added""","""  @Test"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,226,"""added""","""  public void test_SingedWithoutSignature() throws Exception {"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,227,"""added""","""    JWT inputJwt = new JWT()"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,228,"""added""","""        .setSubject(""123456789"")"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,229,"""added""","""        .setIssuedAt(ZonedDateTime.now(ZoneOffset.UTC))"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,230,"""added""","""        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).plusHours(2));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,231,"""added""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,232,"""added""","""    String encodedJWT = JWT.getEncoder().encode(inputJwt, HMACSigner.newSHA256Signer(""secret""));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,233,"""added""","""    String encodedJWTNoSignature = encodedJWT.substring(0, encodedJWT.lastIndexOf('.') + 1);"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,234,"""added""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,235,"""added""","""    expectException(InvalidJWTSignatureException.class, () -> JWT.getDecoder().decode(encodedJWTNoSignature, HMACVerifier.newVerifier(""secret"")));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,236,"""added""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,237,"""added""","""    // Also cannot be decoded even if the caller calls decode w/out a signature because the header still indicates a signature algorithm."""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,238,"""added""","""    expectException(InvalidJWTSignatureException.class, () -> JWT.getDecoder().decode(encodedJWTNoSignature));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_SingedWithoutSignature()""",226,239,-1,-1,239,"""added""","""  }"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,240,"""added""",""""""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,241,"""added""","""  @Test"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,242,"""added""","""  public void test_badEncoding() throws Exception {"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,243,"""added""","""    Verifier verifier = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(""src/test/resources/rsa_public_key_2048.pem""))));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,244,"""added""","""    // add a space to the header, invalid Base64 character point 20 (space)"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,245,"""added""","""    expectException(InvalidJWTException.class, ()"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,246,"""added""","""        -> JWT.getDecoder().decode(""eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9 .foo.bar"", verifier));"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""JWTTest::test_badEncoding()""",242,247,198,203,247,"""added""","""  }"""
"""src/test/java/org/primeframework/jwt/JWTTest.java""","""""",-1,-1,-1,-1,248,"""added""",""""""
